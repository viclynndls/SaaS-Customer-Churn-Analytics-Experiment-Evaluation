-- Create a warehouse
CREATE OR REPLACE WAREHOUSE WH_ANALYTICS
  WAREHOUSE_SIZE = XSMALL
  AUTO_SUSPEND = 60
  AUTO_RESUME = TRUE
  INITIALLY_SUSPENDED = TRUE;

-- Create a database
CREATE OR REPLACE DATABASE CX_ANALYTICS;

-- Create a schema for your raw CSVs
CREATE OR REPLACE SCHEMA CX_ANALYTICS.RAW;

-- Use them
USE WAREHOUSE WH_ANALYTICS;
USE DATABASE CX_ANALYTICS;
USE SCHEMA RAW;

USE DATABASE CX_ANALYTICS;
USE SCHEMA RAW;

CREATE OR REPLACE TABLE USERS_RAW (
  USER_ID             STRING,
  SIGNUP_DATE         STRING,
  COUNTRY             STRING,
  AGE                 STRING,
  GENDER              STRING,
  PLAN_TYPE           STRING,
  ACQUISITION_CHANNEL STRING,
  PRIMARY_DEVICE      STRING
);

CREATE OR REPLACE TABLE SUBSCRIPTIONS_RAW (
  SUBSCRIPTION_ID  STRING,
  USER_ID          STRING,
  START_DATE       STRING,
  END_DATE         STRING,
  BILLING_PERIOD   STRING,
  PRICE_USD        STRING,
  IS_ACTIVE        STRING
);

CREATE OR REPLACE TABLE EVENTS_RAW (
  EVENT_ID     STRING,
  USER_ID      STRING,
  EVENT_TIME   STRING,
  EVENT_TYPE   STRING,
  SESSION_ID   STRING,
  DEVICE_TYPE  STRING,
  PLATFORM     STRING
);

CREATE OR REPLACE TABLE SURVEY_RESPONSES_RAW (
  RESPONSE_ID    STRING,
  USER_ID        STRING,
  RESPONSE_DATE  STRING,
  NPS_SCORE      STRING,
  CSAT_SCORE     STRING,
  EASE_OF_USE    STRING,
  COMMENT_TEXT   STRING
);

CREATE OR REPLACE TABLE EXPERIMENT_ASSIGNMENTS_RAW (
  EXP_ASSIGNMENT_ID STRING,
  USER_ID           STRING,
  EXPERIMENT_NAME   STRING,
  VARIANT           STRING,
  ASSIGNMENT_DATE   STRING
);

SELECT * FROM CX_ANALYTICS.RAW.USERS_RAW LIMIT 10;

USE DATABASE CX_ANALYTICS;
USE SCHEMA RAW;

SELECT * FROM USERS_RAW              LIMIT 10;
SELECT * FROM SUBSCRIPTIONS_RAW      LIMIT 10;
SELECT * FROM EVENTS_RAW             LIMIT 10;
SELECT * FROM SURVEY_RESPONSES_RAW   LIMIT 10;
SELECT * FROM EXPERIMENT_ASSIGNMENTS_RAW LIMIT 10;

CREATE OR REPLACE SCHEMA CX_ANALYTICS.TRANSFORM;

CREATE OR REPLACE SCHEMA CX_ANALYTICS.ANALYTICS;
